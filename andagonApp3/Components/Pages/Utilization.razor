@page "/utilization"
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize(Roles = "User")]

<PageTitle>Mitarbeiterauslastung</PageTitle>

<h1>Auslastung von Mitarbeitern</h1>

<EditForm Model="this" OnValidSubmit="Calculate">
    <InputNumber @bind-Value="EmployeeId" class="form-control" placeholder="Mitarbeiter-ID" />
    <InputDate @bind-Value="StartDate" class="form-control" />
    <InputDate @bind-Value="EndDate" class="form-control" />
    <button class="btn btn-primary" type="submit">Berechnen</button>
</EditForm>

@if (Utilization != null)
{
    <p>Auslastung: @Utilization:P2</p>
}

@code {
    private long EmployeeId { get; set; }
    private DateTime StartDate { get; set; } = DateTime.Today.AddDays(-7);
    private DateTime EndDate { get; set; } = DateTime.Today;
    private double? Utilization;

    private async Task Calculate()
    {
        Utilization = await OdooManager.GetEmployeeUtilization(EmployeeId, StartDate, EndDate);
    }
}
